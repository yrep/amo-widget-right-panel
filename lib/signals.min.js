!function(i,n){"object"==typeof exports&&"undefined"!=typeof module?n(exports,require("preact"),require("preact/hooks"),require("@preact/signals-core")):"function"==typeof define&&define.amd?define(["exports","preact","preact/hooks","@preact/signals-core"],n):n((i||self).preactSignals={},i.preact,i.preactHooks,i.preactSignalsCore)}(this,function(i,n,t,e){var o,r,f,u=[],a=[];e.effect(function(){o=this.N})();function c(i,t){n.options[i]=t.bind(null,n.options[i]||function(){})}function s(i){if(f)f();f=i&&i.S()}function v(i){var o=this,r=i.data,f=useSignal(r);f.value=r;var u=t.useMemo(function(){var i=o,t=o.__v;while(t=t.__)if(t.__c){t.__c.__$f|=4;break}var r=e.computed(function(){var i=f.value.value;return 0===i?0:!0===i?"":i||""}),u=e.computed(function(){return!Array.isArray(r.value)&&!n.isValidElement(r.value)}),a=e.effect(function(){this.N=_;if(u.value){var n=r.value;if(i.__v&&i.__v.__e&&3===i.__v.__e.nodeType)i.__v.__e.data=n}}),c=o.__$u.d;o.__$u.d=function(){a();c.call(this)};return[u,r]},[]),a=u[0],c=u[1];return a.value?c.peek():c.value}v.displayName="ReactiveTextNode";Object.defineProperties(e.Signal.prototype,{constructor:{configurable:!0,value:void 0},type:{configurable:!0,value:v},props:{configurable:!0,get:function(){return{data:this}}},__b:{configurable:!0,value:1}});c("__b",function(i,n){if("function"==typeof n.type&&"undefined"!=typeof window&&window.__PREACT_SIGNALS_DEVTOOLS__)window.__PREACT_SIGNALS_DEVTOOLS__.exitComponent();if("string"==typeof n.type){var t,o=n.props;for(var r in o)if("children"!==r){var f=o[r];if(f instanceof e.Signal){if(!t)n.__np=t={};t[r]=f;o[r]=f.peek()}}}i(n)});c("__r",function(i,t){if("function"==typeof t.type&&"undefined"!=typeof window&&window.__PREACT_SIGNALS_DEVTOOLS__)window.__PREACT_SIGNALS_DEVTOOLS__.enterComponent(t.type.displayName||t.type.name||"Unknown");if(t.type!==n.Fragment){s();var o,f=t.__c;if(f){f.__$f&=-2;if(void 0===(o=f.__$u))f.__$u=o=function(i){var n;e.effect(function(){n=this});n.c=function(){f.__$f|=1;f.setState({})};return n}()}r=f;s(o)}i(t)});c("__e",function(i,n,t,e){if("undefined"!=typeof window&&window.__PREACT_SIGNALS_DEVTOOLS__)window.__PREACT_SIGNALS_DEVTOOLS__.exitComponent();s();r=void 0;i(n,t,e)});c("diffed",function(i,n){if("function"==typeof n.type&&"undefined"!=typeof window&&window.__PREACT_SIGNALS_DEVTOOLS__)window.__PREACT_SIGNALS_DEVTOOLS__.exitComponent();s();r=void 0;var t;if("string"==typeof n.type&&(t=n.__e)){var e=n.__np,o=n.props;if(e){var f=t.U;if(f)for(var u in f){var a=f[u];if(void 0!==a&&!(u in e)){a.d();f[u]=void 0}}else{f={};t.U=f}for(var c in e){var v=f[c],h=e[c];if(void 0===v){v=d(t,c,h,o);f[c]=v}else v.o(h,o)}}}i(n)});function d(i,n,t,o){var r=n in i&&void 0===i.ownerSVGElement,f=e.signal(t);return{o:function(i,n){f.value=i;o=n},d:e.effect(function(){this.N=_;var t=f.value.value;if(o[n]!==t){o[n]=t;if(r)i[n]=t;else if(t)i.setAttribute(n,t);else i.removeAttribute(n)}})}}c("unmount",function(i,n){if("string"==typeof n.type){var t=n.__e;if(t){var e=t.U;if(e){t.U=void 0;for(var o in e){var r=e[o];if(r)r.d()}}}}else{var f=n.__c;if(f){var u=f.__$u;if(u){f.__$u=void 0;u.d()}}}i(n)});c("__h",function(i,n,t,e){if(e<3||9===e)n.__$f|=2;i(n,t,e)});n.Component.prototype.shouldComponentUpdate=function(i,n){var t=this.__$u,e=t&&void 0!==t.s;for(var o in n)return!0;if(this.__f||"boolean"==typeof this.u&&!0===this.u){var r=2&this.__$f;if(!(e||r||4&this.__$f))return!0;if(1&this.__$f)return!0}else{if(!(e||4&this.__$f))return!0;if(3&this.__$f)return!0}for(var f in i)if("__source"!==f&&i[f]!==this.props[f])return!0;for(var u in this.props)if(!(u in i))return!0;return!1};function useSignal(i,n){return t.useState(function(){return e.signal(i,n)})[0]}var h="undefined"==typeof requestAnimationFrame?setTimeout:function(i){var n=function(){clearTimeout(t);cancelAnimationFrame(e);i()},t=setTimeout(n,35),e=requestAnimationFrame(n)},l=function(i){queueMicrotask(function(){queueMicrotask(i)})};function p(){e.batch(function(){var i;while(i=u.shift())o.call(i)})}function w(){if(1===u.push(this))(n.options.requestAnimationFrame||h)(p)}function y(){e.batch(function(){var i;while(i=a.shift())o.call(i)})}function _(){if(1===a.push(this))(n.options.requestAnimationFrame||l)(y)}i.Signal=e.Signal;i.batch=e.batch;i.computed=e.computed;i.effect=e.effect;i.signal=e.signal;i.untracked=e.untracked;i.useComputed=function(i,n){var o=t.useRef(i);o.current=i;r.__$f|=4;return t.useMemo(function(){return e.computed(function(){return o.current()},n)},[])};i.useSignal=useSignal;i.useSignalEffect=function(i,n){var o=t.useRef(i);o.current=i;t.useEffect(function(){return e.effect(function(){this.N=w;return o.current()},n)},[])}});//# sourceMappingURL=signals.min.js.map
